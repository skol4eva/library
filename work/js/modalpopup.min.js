/*!
    project: ModalPopup
    update: 2015-09-16 15:50:19 PM
    author: ncsoft-pdw
*/
!function(a){"use strict";var b=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},c=function(a,c){this._node=jQuery('<div class="ncUiBackdrop"></div>'),this.onclicked=jQuery.Callbacks(),this._parent=a._parent||jQuery("body"),this._options={position:"fixed",top:0,left:0,right:0,bottom:0,"z-index":100010,background:"#000",opacity:"0.5",filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=50)"},this._options.isBackdropClickClose=c,this._options=b(this._options,a),this._options._parent="",this._init()};c.prototype.show=function(){this._node.show()},c.prototype.hide=function(){this._node.hide()},c.prototype.remove=function(){this._node.remove()},c.prototype._init=function(){if(this._parent.has(this._node).length)return this._node;var a=this._options;return a._parent="",this._node.hide().css(a),this._parent.append(this._node),this.addEvent(),this._node},c.prototype.addEvent=function(){var a=this;this._node.click(function(){a._options.isBackdropClickClose&&a.onclicked.fire()})};var d=function(a){this._node=jQuery('<div class="ncUiModal"></div>'),this._options={_parent:jQuery("body"),type:"",url:"",w:"",h:"",content:"",isBackdrop:!0,isBackdropClickClose:!0,backdropCss:{},isEsc:!1,isMove:!1,top:0,left:0,movieParams:"?autoplay=1&version=3&enablejsapi=1",isAutoButton:!1,isRemoveButton:!1,hideCallback:function(){},showCallback:function(){}},this._options=b(this._options,a),this._content="",this._options.backdropCss._parent=this._options._parent,this._backdrop=this._options.isBackdrop?new c(this._options.backdropCss,this._options.isBackdropClickClose):null};d.prototype.getNode=function(){return this._node},d.prototype._append=function(){this._options._parent.append(this._node)},d.prototype.show=function(){this._backdrop&&this._backdrop.show(),this._node.show()},d.prototype.remove=function(){this._backdrop&&this._backdrop.remove(),this._node.find("iframe").attr("src",""),this._node.remove()},d.prototype.hide=function(){this._backdrop&&this._backdrop.hide(),this._node.hide()},d.prototype._init=function(){this._append(),this.setContent(),this._setModal(),this._setCloseButton(),this._addEvent(),this.hide(),this._content.show()},d.prototype.setContent=function(){this._content=jQuery(this._options.content).hide(),this._node.append(this._content),this._options.w=this._content.outerWidth(),this._options.h=this._content.outerHeight()},d.prototype._setCloseButton=function(a){this._closeButton=this._content&&this._content.find(".layerClose").length?this._content.find(".layerClose"):[],0===this._closeButton.length&&this._options.isAutoButton&&(this._closeButton=jQuery('<span class="layerClose">'+(a||"close")+"</span>"),this._node.append(this._closeButton),this._closeButton.css({position:"absolute","text-indent":"-119988px",cursor:"pointer","z-index":100050}))},d.prototype._addEvent=function(){var a=this;this._backdrop&&this._backdrop.onclicked.add(function(){a.hide()})},d.prototype._setModal=function(){var a=this._options,b=a.w||960,c=a.h||540,d=jQuery(window).scrollLeft();this._node.css({position:"fixed",left:"50%",top:"50%",marginTop:-c/2,marginLeft:-b/2+d,"z-index":100020}).width(b).height(c).show(),c>jQuery(window).height()&&this._node.css({position:"absolute"})};var e=function(a){this.modal=new d(a);var a=this.modal._options;this._url=a.url+a.movieParams,this._frame="","youtube"===a.type?(this._init(),this.modal.getNode().addClass("youtubeLayer")):this.modal._init(),this._addEvent()};e.prototype._isMovePosition=function(){var a=this.modal,b=0;a._options.isMove&&(b="auto"===a._options.top?jQuery(window).scrollTop()+30:a._options.top,"auto"!=a._options.left&&0!=a._options.left&&a._node.css({"margin-left":0,left:a._options.left+"px"}),a._node.css({position:"absolute","margin-top":"auto",top:b+"px"}))},e.prototype._addEvent=function(){var a=this;this.modal._backdrop&&this.modal._backdrop.onclicked.add(function(){a.hide()}),jQuery(window).resize(function(){var b=a.modal,c=b._options.h||540;c>jQuery(window).height()?b._node.css({position:"absolute","margin-top":"auto",top:"50px"}):b._node.css({position:"fixed"}),a._isMovePosition()}).trigger("resize"),a.modal._options.isEsc&&jQuery(window).on("keydown",function(b){27===b.keyCode&&a.hide()}),this.modal._closeButton.length&&this.modal._closeButton.click(function(b){b.preventDefault(),a.modal._options.isRemoveButton?a.remove():a.hide()})},e.prototype._init=function(){this.modal._append(),this.modal._setModal(),this.modal._setCloseButton(),this.modal._addEvent(),this.modal.hide()},e.prototype.changeContent=function(a){var b=(this.modal._options,this.modal._content);b.remove(),b=jQuery(a),this.modal._node.append(b)},e.prototype.resetSize=function(){var a=this.modal._options,b=this.modal._content;a.w=b.outerWidth(),a.h=b.outerHeight(),this.modal._setModal(),this._isMovePosition()},e.prototype.setYoutubeUrl=function(a){this._url=a},e.prototype.show=function(){var a=this.modal._options;"youtube"===a.type&&(this._frame?this._frame.attr("src",this._url+a.movieParams):this.setContent()),this._isMovePosition(),this.modal.show(),a.showCallback&&a.showCallback()},e.prototype.remove=function(){var a=this.modal._options;"youtube"===a.type&&this._frame&&this._frame.remove(),this.modal.remove()},e.prototype.hide=function(){var a=this.modal._options;"youtube"===a.type&&this._frame&&this._frame.attr("src",""),this.modal.hide(),a.hideCallback&&a.hideCallback()},e.prototype.setContent=function(){var a=this.modal._options,b=a.w,c=a.h;this._frame=jQuery('<iframe width="'+b+'" height="'+c+'" src="'+this._url+'" frameborder="0" allowfullscreen></iframe>'),this.modal._node.append(this._frame)},"undefined"==typeof a.nc&&(a.nc={}),"undefined"==typeof a.nc.ui&&(a.nc.ui={}),a.nc.ui.Backdrop=c,a.nc.ui.Modal=e}("undefined"==typeof exports?window:exports);